<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Swiper with GSAP</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
  <link rel="stylesheet" href="css.css">
</head>

<body>
  <header>
    <h1>
      <a href="">
        <img src="src/logo.png" alt="다이나믹 로고">
      </a>
    </h1>
    <nav>
      <div>Main</div>
      <div>Quality</div>
      <div>Flavor</div>
      <div>About Us</div>
    </nav>
  </header>
  <div class="view swiper">
    <div class="swiper-wrapper">
      <div class="swiper-slide">
        <section class="section1">
          <div class="conMain-ellipseBox"></div>
          <div class="conMain-text beMore">
            <!-- <img src="src/text-be-more.png" alt="BE-MORE"> -->
            <p>BE MORE</p>
          </div>
          <div class="conMain-products">
            <img src="src/product-01.png" alt="다이나믹 메인 제품 이미지">
          </div>
          <div class="conMain-text dynamic">
            <!-- <img src="src/text-dynamic.png" alt="DYNAMIC"> -->
            <p>DYNAMIC</p>
          </div>
        </section>
      </div>
      <div class="swiper-slide">
        <section class="section2">
          <div class="conMain-centerBox">
            <div class="conMain-products2">
              <img src="src/product-02.png" alt="다이나믹 메인 제품 이미지2">
            </div>
            <div class="conMain-text2">
              <p class="title">컴팩트한 사이즈로 손 안에 쏙 들어오는 안정적인 그립감</p>
            </div>
            <div class="conMain-text3">
              <p class="count"><b id="count">0</b> <span>PUFFS</span></p>
              <p class="title">10ML 대용량으로 하루종일 베이핑해도 걱정없이</p>
            </div>
            <div class="conMain-text4">
              <p class="detail">Refill Container Capacity<span>10 mL</span></p>
              <p class="detail">Nicotine Strength<span>9.8 mg/mL</span></p>
              <p class="detail">Puffs<span>Up to 5000</span></p>
            </div>
          </div>
        </section>
      </div>
      <div class="swiper-slide">
        <section class="section3">
          <div class="conMain-centerBox2">
            <div class="conMain-products3">
              <img class="bottom" src="src/product-detail-bottom.png" alt="다이나믹 메인 제품 하단 이미지">
              <img class="light" src="src/batteryGreen.png" alt="배터리 완충 색상 연두색">
            </div>
            <div class="conMain-text5">
              <p class="title">C-type 충전방식</p>
              <p class="detail">Battery Capacity<span>550 mAh</span></p>
            </div>
            <div class="conMain-text6">
              <p class="title">배터리 표시</p>
              <ul class="batteryDetailBox">
                <li class="detail">
                  <img src="src/batterRed.png" alt="배터리 부족">
                  배터리 부족
                </li>
                <li class="detail">
                  <img src="src/batteryBlue.png" alt="중간">
                  중간
                </li>
                <li class="detail">
                  <img src="src/batteryGreen.png" alt="완충">
                  완충
                </li>
              </ul>
            </div>
          </div>
        </section>
      </div>
      <div class="swiper-slide">
        <section class="section4">
          <div class="conQuality-bg orange">
            <div class="conQuality-bestQuality">
              <img class="afterimage" src="src/text-best-quality.png" alt="BEST QUALITY">
              <img class="forward" src="src/text-best-quality.png" alt="BEST QUALITY">
            </div>
            <div class="conQuality-text1">
              <p class="detail index0"><b>국내 유일</b> 자체 생산 <b>합성니코틴 사용</b></p>
              <p class="detail index1">담배특이 니트로사민 <b>불검출</b></p>
            </div>
          </div>
        </section>
      </div>
      <div class="swiper-slide">
        <section class="section5">
          5
        </section>
      </div>
    </div>
  </div>


  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  <script>
    // 미디어쿼리 설정
    const mediaQueryTablet = window.matchMedia("(max-width: 1280px)");
    const mediaQueryMobile = window.matchMedia("(max-width: 640px)");
  
    let initialScrollCompleted = false; // 초기 애니메이션 완료 상태
    let firstScrollCompleted = false; // 첫 번째 스크롤 애니메이션 완료 상태
  
    // Swiper 설정
    const swiper = new Swiper('.view.swiper', {
      direction: 'vertical',
      mousewheel: {
        enabled: false, // 초기에는 Swiper 스크롤 비활성화
      },
      on: {
        slideChangeTransitionStart: () => {
          const activeSection = document.querySelector('.swiper-slide-active section');
  
          // 1번 슬라이드로 돌아오면 상태 초기화
          if (activeSection.classList.contains('section1')) {
            resetToInitialState(); // 상태 초기화
          }

          // 2번 슬라이드 활성화 설정
          if (activeSection.classList.contains('section2')) {
            activateSecondSlide(); // 두 번째 슬라이드 설정 함수 호출
          }

          // 3번 슬라이드 활성화 설정
          if (activeSection.classList.contains('section3')) {
            activateThirdSlide(); // 세 번째 슬라이드 설정 함수 호출
          }

          // 4번 슬라이드 활성화 설정
          if (activeSection.classList.contains('section4')) {
            activateFourthSlide(); // 네 번째 슬라이드 설정 함수 호출
          }
        },
      },
    });
  
    // 초기 애니메이션 설정
    const initialAnimation = () => {
      const animationScale = mediaQueryMobile.matches
        ? 2.5
        : mediaQueryTablet.matches
        ? 1.8
        : 1;
  
      gsap.fromTo(
        ".conMain-products",
        { scale: 0.4, opacity: 0.4, filter: "blur(1.8vw)" },
        {
          scale: animationScale,
          opacity: 1,
          filter: "blur(0px)",
          duration: 1,
          ease: "power3.inOut",
          onComplete: () => {
            initialScrollCompleted = true; // 초기 애니메이션 완료 상태
          },
        }
      );
    };
  
    // 첫 번째 스크롤 애니메이션
    const firstScrollAnimation = () => {
      const animationScale = mediaQueryMobile.matches
        ? 550
        : mediaQueryTablet.matches
        ? 450
        : 400;
  
      gsap.timeline({
        onComplete: () => {
          firstScrollCompleted = true; // 첫 번째 스크롤 완료 상태
          swiper.mousewheel.enable(); // Swiper 활성화
        },
      })
        .fromTo(
          ".conMain-text.beMore",
          { right: "100%", opacity: 0 },
          { right: "8vw", opacity: 1, duration: 0.4 }
        )
        .fromTo(
          ".conMain-text.dynamic",
          { left: "100%", opacity: 0 },
          { left: "8vw", opacity: 1, duration: 0.4 },
          "<"
        )
        .fromTo(
          ".conMain-ellipseBox",
          { opacity: 1, scale: 0 },
          { opacity: 1, scale: animationScale, duration: 0.4, ease: "power1.inOut" },
          "<"
        )
        .fromTo(
          ".conMain-ellipseBox",
          { rotate: -15, backgroundColor: "#ffffff", borderRadius: "50%" },
          { scaleY: 100, rotate: -35, backgroundColor: "#F81884", borderRadius: 0, duration: 0.6, ease: "power3.inOut" },
          "<50%"
        )
        .fromTo(
          ".conMain-text p",
          { color: "#F81884" },
          { color: "#ffffff", duration: 0.6, ease: "power1.inOut" },
          "<"
        )
    };

    // 두 번째 슬라이드 애니메이션 설정 함수
    const activateSecondSlide = () => {
    gsap.timeline()
      .fromTo(
        ".conMain-products2",
        { opacity: 0, scale: 0.9 },
        { opacity: 1, scale: 1, duration: 2, ease: "power3.out" }
      )
      .fromTo(
        ".conMain-text2",
        { opacity: 0, y: 50 },
        { opacity: 1, y: 0, duration: 2, ease: "power3.out", delay: 0.1 },
        "<"
      )
      .fromTo(
        ".conMain-text3",
        { opacity: 0, y: 50 },
        { opacity: 1, y: 0, duration: 2, ease: "power3.out", delay: 0.2 },
        "<"
      )
      .fromTo(
        ".conMain-text3 .count b",
        { innerText: 0 },
        {
          innerText: 10000,
          duration: 1,
          ease: "linear",
          snap: { innerText: 1 },
          onUpdate: function () {
            const countElement = document.querySelector(".conMain-text3 #count");
            countElement.textContent = Math.floor(this.targets()[0].innerText);
          },
        },
        "<"
      )
      .fromTo(
        ".conMain-text4 .detail",
        { opacity: 0, y: 20 },
        { opacity: 1, y: 0, stagger: 0.2, duration: 1, ease: "power3.out", delay: 0.3},
        "<"
      );
  };

  // 세 번째 슬라이드 애니메이션 설정 함수
  const activateThirdSlide = () => {
    gsap.timeline()
      .fromTo(
        ".conMain-products3",
        { opacity: 0, scale: 0.9 },
        { opacity: 1, scale: 1, duration: 2, ease: "power3.out" }
      )
      .fromTo(
        ".conMain-text5",
        { opacity: 0, y: 50 },
        { opacity: 1, y: 0, duration: 2, ease: "power3.out", delay: 0.2 },
        "<"
      )
      .fromTo(
        ".conMain-text6",
        { opacity: 0, y: 50 },
        { opacity: 1, y: 0, duration: 2, ease: "power3.out", delay: 0.4 },
        "<"
      );
  };

    // 네 번째 슬라이드 애니메이션 설정 함수
    const activateFourthSlide = () => {
    gsap.timeline()
      .fromTo('.conQuality-bestQuality', 
        { opacity: 0.5, top: '50%', transform: 'translate(-50%, -50%) scale(2)' },
        { opacity: 1, top: '32%', transform: 'translate(-50%, -50%) scale(0.3)', duration: 0.3 }
      )
      .fromTo('.conQuality-bg.orange', 
        { backgroundColor: '#0d0d0d' },
        { backgroundColor: '#FF560E' },
        '<10%'
      )
      .fromTo('.conQuality-bestQuality img.afterimage', 
        { opacity: 1, transform: 'scale(1)' }, 
        { opacity: 0, transform: 'scale(1.3)' }, 
        "<10%"
      )
      .fromTo('.conQuality-text1 .detail.index0', 
        { opacity: 0 },
        { opacity: 1 }
      )
      .fromTo('.conQuality-text1 .detail.index1',
        { opacity: 0 },
        { opacity: 1 },
      );
  };







  
    // 상태 초기화 함수
    const resetToInitialState = () => {
      swiper.mousewheel.disable(); // Swiper 비활성화
      initialScrollCompleted = false;
      firstScrollCompleted = false;
  
      // 요소 상태 초기화
      gsap.set(".conMain-products", { scale: 0.4, opacity: 0.4, filter: "blur(1.8vw)" });
      gsap.set(".conMain-text.beMore", { right: "100%", opacity: 0 });
      gsap.set(".conMain-text.dynamic", { left: "100%", opacity: 0 });
      gsap.set(".conMain-ellipseBox", { opacity: 1, scale: 0 });
  
      // 초기 애니메이션 재실행
      initialAnimation();
    };
  
















    // 스크롤 이벤트 감지
    window.addEventListener(
      "wheel",
      (event) => {
        if (!initialScrollCompleted) {
          event.preventDefault(); // 초기 스크롤 차단
        } else if (!firstScrollCompleted) {
          event.preventDefault(); // 첫 번째 스크롤 동작 처리
          firstScrollAnimation(); // 첫 번째 스크롤 애니메이션 실행
        }
      },
      { passive: false }
    );
  
    // 초기 애니메이션 자동 실행
    document.addEventListener("DOMContentLoaded", () => {
      initialAnimation();
    });
  </script>
  
  
  
  

</body>

</html>